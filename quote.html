<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoices | Toolbox Pay</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --bg-deep: #05070A;
            --bg-panel: #0B0E14;
            --industrial-orange: #FF9500;
            --border-slate: #1E232D;
        }

        body { 
            background-color: var(--bg-deep); 
            color: #FFFFFF; 
            font-family: 'Inter', sans-serif; 
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* HARD-CODED TOP HEADER */
        .header-bar {
            background-color: var(--bg-panel);
            border-bottom: 3px solid var(--industrial-orange);
            height: 70px;
            display: flex;
            align-items: center;
            padding: 0 30px;
            justify-content: space-between;
            flex-shrink: 0;
            z-index: 999;
        }

        .workspace { 
            display: flex; 
            flex: 1; 
            overflow: hidden; 
        }

        .sidebar {
            width: 400px;
            padding: 25px;
            border-right: 1px solid var(--border-slate);
            overflow-y: auto;
            background: #080A0F;
        }

        .industrial-input {
            background: #11141B;
            border: 1px solid var(--border-slate);
            border-radius: 4px;
            color: white;
            padding: 12px;
            width: 100%;
            outline: none;
            font-size: 13px;
            margin-bottom: 15px;
        }

        .industrial-input:focus { border-color: var(--industrial-orange); }

        .label-text {
            font-size: 10px;
            font-weight: 900;
            color: #4B5563;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            display: block;
            margin-bottom: 5px;
        }

        /* INVOICE POSITIONING */
        .preview-area {
            flex: 1;
            background-color: #020305;
            overflow-y: auto;
            padding: 60px;
            display: flex;
            justify-content: center;
        }

        .invoice-paper {
            background: white;
            color: #1a1a1a;
            width: 100%;
            max-width: 800px;
            min-height: 1120px; /* A4 Ratio */
            box-shadow: 0 40px 80px rgba(0,0,0,0.6);
            padding: 120px 80px 80px 80px; /* Pushes invoice text down */
            display: flex;
            flex-direction: column;
            position: relative;
        }

        @media print {
            body * { visibility: hidden; }
            #invoiceSheet, #invoiceSheet * { visibility: visible; }
            #invoiceSheet { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; padding: 60px; }
        }
    </style>
</head>
<body>

    <header class="header-bar">
        <div class="flex items-center gap-2">
            <span class="font-black text-2xl tracking-tighter uppercase">
                <span class="text-[#FF9500]">TOOLBOX</span>PAY 
            </span>
        </div>
        <div class="flex items-center gap-6">
            <button id="clearFormBtn" class="text-slate-500 font-bold text-xs uppercase hover:text-white transition-colors">Clear All</button>
            <button onclick="window.print()" class="bg-[#FF9500] text-black px-6 py-2.5 rounded font-black text-xs uppercase shadow-lg shadow-orange-500/20">Print / Save PDF</button>
        </div>
    </header>

    <div class="workspace">
        <aside class="sidebar">
            <h2 class="text-sm font-black mb-8 text-slate-400 uppercase tracking-widest border-b border-slate-800 pb-2">Invoice Configuration</h2>
            
            <span class="label-text">Customer Name</span>
            <input type="text" id="custName" class="industrial-input" placeholder="Mary Smith">

            <span class="label-text">Site Address</span>
            <textarea id="custAddr" class="industrial-input" rows="2" placeholder="Street, Town..."></textarea>

            <span class="label-text">Work Description (AI extraction)</span>
            <textarea id="workDesc" class="industrial-input" style="min-height: 140px;" placeholder="e.g. 150 labour and 60 parts"></textarea>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <span class="label-text">Labour (Â£)</span>
                    <input type="number" id="labourCost" class="industrial-input" value="0">
                </div>
                <div>
                    <span class="label-text">Parts (Â£)</span>
                    <input type="number" id="partsCost" class="industrial-input" value="0">
                </div>
            </div>

            <div class="mt-8 pt-8 border-t border-slate-800">
                <span class="label-text">Your Business Name</span>
                <input type="text" id="bizName" class="industrial-input" placeholder="Company Ltd">
                
                <span class="label-text">Bank Details</span>
                <div class="grid grid-cols-2 gap-4">
                    <input type="text" id="bankSort" class="industrial-input" placeholder="Sort Code">
                    <input type="text" id="bankAcc" class="industrial-input" placeholder="Account No">
                </div>
            </div>
        </aside>

        <main class="preview-area">
            <div class="invoice-paper" id="invoiceSheet">
                </div>
        </main>
    </div>

    <script src="src/quote.js"></script>
</body>
</html>
ðŸ“‚ Complete Block: src/quote.js
Location: /src/quote.js
Directory: C:\Users\Emerald\Desktop\toolboxpay-v4.0\src\quote.js
Action: Re-verified the extraction logic to ensure the total updates instantly when text is typed.

JavaScript
/**
 * TOOLBOX PAY - Intelligence Engine v5.3
 * Specialising in automatic price extraction and layout balance.
 */

document.addEventListener('DOMContentLoaded', () => {
    const el = {
        custName: document.getElementById('custName'),
        custAddr: document.getElementById('custAddr'),
        workDesc: document.getElementById('workDesc'),
        labourCost: document.getElementById('labourCost'),
        partsCost: document.getElementById('partsCost'),
        bizName: document.getElementById('bizName'),
        bankSort: document.getElementById('bankSort'),
        bankAcc: document.getElementById('bankAcc'),
        invoiceSheet: document.getElementById('invoiceSheet'),
        clearBtn: document.getElementById('clearFormBtn')
    };

    const VAT_RATE = 0.20;

    function refreshInvoice() {
        let rawText = el.workDesc.value;
        let cleanText = rawText;

        // 1. LABOUR EXTRACTION
        const labRegex = /(\d+(?:\.\d+)?)\s*(?:pounds?|Â£)?\s*labour|labour\s*(?:at|is|of|for)?\s*(?:Â£|pounds?)?\s*(\d+(?:\.\d+)?)/i;
        const labMatch = rawText.match(labRegex);
        if (labMatch) {
            el.labourCost.value = labMatch[1] || labMatch[2];
            cleanText = cleanText.replace(labMatch[0], "");
        }

        // 2. PARTS EXTRACTION
        const partsRegex = /(\d+(?:\.\d+)?)\s*(?:pounds?|Â£)?\s*(?:parts|materials|tools|items)|(?:parts|materials|tools|items)\s*(?:at|is|of|for)?\s*(?:Â£|pounds?)?\s*(\d+(?:\.\d+)?)/i;
        const partsMatch = rawText.match(partsRegex);
        if (partsMatch) {
            el.partsCost.value = partsMatch[1] || partsMatch[2];
            cleanText = cleanText.replace(partsMatch[0], "");
        }

        // Grammar Scrubbing
        cleanText = cleanText.replace(/at a cost of|totaling|costing|and|plus/gi, "").replace(/\s\s+/g, ' ').trim();

        const lVal = parseFloat(el.labourCost.value) || 0;
        const pVal = parseFloat(el.partsCost.value) || 0;
        const sub = lVal + pVal;
        const vat = sub * VAT_RATE;
        const total = sub + vat;

        // 3. RENDER FINAL DOCUMENT
        el.invoiceSheet.innerHTML = `
            <div class="flex justify-between items-start mb-24">
                <div>
                    <h1 class="text-3xl font-black tracking-tighter uppercase">
                        <span class="text-[#FF9500]">TOOLBOX</span>PAY
                    </h1>
                    <div class="mt-4 text-[11px] font-bold text-slate-500 uppercase">
                        ${el.bizName.value || 'YOUR BUSINESS NAME'}<br>
                        Specialising in Professional Trade
                    </div>
                </div>
                <div class="text-right">
                    <h2 class="text-5xl font-light text-slate-100 uppercase tracking-tighter mb-2">Invoice</h2>
                    <div class="text-[10px] font-black text-slate-400 uppercase tracking-widest">
                        Ref: INV-1001 â€¢ ${new Date().toLocaleDateString('en-GB')}
                    </div>
                </div>
            </div>

            <div class="mb-20 border-l-4 border-[#FF9500] pl-8 py-2 bg-slate-50">
                <div class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-2">Invoice To:</div>
                <div class="text-base font-bold text-slate-900 uppercase tracking-tight">${el.custName.value || '---'}</div>
                <div class="text-[11px] text-slate-600 uppercase mt-1 leading-relaxed">
                    ${el.custAddr.value.replace(/\n/g, '<br>') || 'Address not specified'}
                </div>
            </div>

            <div class="flex-1">
                <div class="text-[9px] font-black text-slate-300 uppercase tracking-widest mb-4 border-b border-slate-100 pb-2">Description of Services</div>
                <div class="text-[12px] font-medium text-slate-800 leading-relaxed uppercase mb-20 min-h-[150px]">
                    ${cleanText || 'Awaiting job description details...'}
                </div>
                
                <div class="space-y-5">
                    <div class="flex justify-between text-base border-b border-slate-50 pb-4">
                        <span class="text-slate-400 font-bold uppercase tracking-tight">Professional Trade Labour</span>
                        <span class="font-bold">Â£${lVal.toFixed(2)}</span>
                    </div>
                    <div class="flex justify-between text-base border-b border-slate-50 pb-4">
                        <span class="text-slate-400 font-bold uppercase tracking-tight">Materials & Equipment</span>
                        <span class="font-bold">Â£${pVal.toFixed(2)}</span>
                    </div>
                </div>
            </div>

            <div class="mt-24 flex justify-end">
                <div class="w-72">
                    <div class="flex justify-between text-[11px] mb-3 font-bold text-slate-400 uppercase">
                        <span>Subtotal</span>
                        <span>Â£${sub.toFixed(2)}</span>
                    </div>
                    <div class="flex justify-between text-[11px] mb-8 font-bold text-slate-400 uppercase border-b-2 border-slate-100 pb-5">
                        <span>VAT (20%)</span>
                        <span>Â£${vat.toFixed(2)}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-[11px] font-black uppercase tracking-widest text-slate-400">Total Due</span>
                        <span class="text-5xl font-black text-[#FF9500]">Â£${total.toFixed(2)}</span>
                    </div>
                </div>
            </div>

            <div class="mt-auto pt-12 grid grid-cols-2 gap-12 border-t border-slate-100 pb-4">
                <div>
                    <div class="text-[9px] font-black text-slate-300 uppercase mb-4 tracking-widest">Bank Details</div>
                    <div class="text-[11px] font-bold uppercase leading-relaxed">
                        BANK TRANSFER<br>
                        SORT CODE: ${el.bankSort.value || '00-00-00'}<br>
                        ACCOUNT NO: ${el.bankAcc.value || '00000000'}
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-[9px] font-black text-slate-300 uppercase mb-4 tracking-widest">Terms</div>
                    <div class="text-[11px] font-bold uppercase leading-relaxed">
                        Payment due on receipt.<br>
                        Thank you for your custom.
                    </div>
                </div>
            </div>
        `;
    }

    // Auto-update on every keypress
    Object.values(el).forEach(input => {
        if(input && (input.tagName === 'INPUT' || input.tagName === 'TEXTAREA')) {
            input.addEventListener('input', refreshInvoice);
        }
    });

    el.clearBtn.addEventListener('click', () => {
        ['custName', 'custAddr', 'workDesc', 'labourCost', 'partsCost'].forEach(id => {
            if(el[id]) el[id].value = id.includes('Cost') ? 0 : "";
        });
        refreshInvoice();
    });

    refreshInvoice();
});